# 파일 업로드 및 DB 정보 할당
1. 웹 애플리케이션에서 파일 업로드 기능을 구현하는 방법을 알아보겠습니다. 파일 업로드는 사용자가 파일을 선택하여 서버로 전송하고,
서버에서 파일을 지정한 후, 해당 파일 정보를 데이터베이스에 저장하여 관리할 수 있는 기능을 다룹니다. 이 과정에서 파일업로드의
구현 방법과 함께 이후 진행하는 특정 게시물에 연관하여 파일 다운로드 하기 위하여 DB 파일 정보 저장하는 방법을 알아봅시다.
2. 목표
	1) 사용자가 파일을 선택하여 서버에 업로드하는 방법을 이해한다.
	2) 업로드된 파일을 서버의 지정된 경로에 저장하고, 해당 파일 정보를 데이터베이스에 저장하는 방법을 학습한다.
	3) 실제 웹 개발 환경에서 파일 업로드 기능을 구현하고, 업로드한 파일을 파일 다운하거나 재활용할 수 있도록 하는 방법을 익힌다.
3. 파일 업로드의 필요성
	1) 웹 애플리케이션에서 파일 업로드 기능은 사용자로부터 파일을 받아 저장하고, 이후에 다운로드하거나 사용하기 위해 필요합니다.
		일반적으로 form 하위 객체에서 type="file"요소를 이용해 파일을 선택하고, 이를 서버에 전송하여 처리합니다.
	2) 기능 프로세스
		- 사용자 입력 후 첨부 파일을 선택하고, 서버로 전송합니다.
		- 서버는 파일을 지정된 경로에 저장하고, 파일명, 등록일 등의 정보를 DB에 저장합니다.
		- 사용자가 해당 파일을 확인하고 다운로드할 수 있습니다.
4. 파일 업로드 처리 순서
	1) 기본 환경 설정(application.properties 설정)
		- 파일 업로드를 처리할 위치와 최소/최대 용량을 설정합니다.
		user.upload=경로명
	2) controller/service단 처리
		- 파일 업로드할 요청 url을 통해 MultiPartFile 객체를 통해 stream으로 특정한 파일이 전송되게 한다.
		- service단에서 위 MultiPartFile 객체를 통해 전달해온 메모리상 객체를 실제 물리적 파일로 저장(File객체)되게 한다.
		- 필요에 따라 해당 경로 파일 정보를 DB에 저장되게 처리한다.
	3) 화면구성(html/jsp)
		- 기본적으로 파일을 업로드에 필요한 정보를 입력하는 form을 처리한다.
		- form 속성 encType="multipart/form-data" 설정
			파일업로드를 처리할려면 form 요소에 encType의 속성을 추가해야 합니다. 이를 파일 전송을 포함한 폼 데이터가 
			서버로 전송될 때, 필요합니다.
		- 파일 입력 필드 추가
			input type="file"요소를 사용하여 파일을 선택할 수 있게 합니다. 여러 파일을 선택하려면 multiple 속성을 추가합니다.
		ex)
		<form action="upload" method="post" enctype="multipart/form-data">
			<input type="file" name="report" multiple="multiple">
5. 처리할 파일..
	resources\application.properties  : 업로드할 경로 설정..
	a04_file.A01_FileController.java
	a04_file.A02_FileService.java
	a04_file.A03_FileDao.java
	webapp\WEB-INF\views\a07_file\a01_fileUpload.jsp 파일업로드할 form
	webapp\WEB-INF\views\a07_file\a02_fileDownload.jsp 파일다운로드 form
	C:\Users\humantech\git\20250927\springweb\src\main\webapp\download
		실제 업로드한 파일이 위치할 경로
	ex)	경로와 파일을 새로 만들어 위 내용 처리 하세요.. 

	
	
	resources\application.properties  : 업로드할 경로 설정..
	a04_file.A04_FileController.java
	a04_file.A05_FileService.java
	a04_file.A06_FileDao.java
	webapp\WEB-INF\views\a07_file\a04_fileUpload.jsp 파일업로드할 form
	webapp\WEB-INF\views\a07_file\a05_fileDownload.jsp 파일다운로드 form
	C:\Users\humantech\git\20250927\springweb\src\main\webapp\download2
			
# 업로드된 파일 정보 저장하기..
1. 테이블 구성..
	파일등록seq, 파일명, 경로명, 등록일, 수정일, 기타정보
2. dao에서 등록 처리
3. service단에 파일 저장시, 등록 처리..

# 다운로드..	
1. 처리 프로세스 
	1) 첨부파일로 등록된 내용을 리스트로 화면에서 확인한다.(DB 처리)
	2) 특정한 파일 정보를 클릭시, 요청값으로 해당 파일명을 get방식으로 요청한다.
		(실무상은 key로 요청을 보내어 다시 DB를 검색해서 파일명을 가져와서 처리-생략)
	3) 파일 다운로드 controller가 해당 파일을 get방식으로 받아서, 파일명과 경로명으로 해당 파일을 Stream 객체로 리턴 처리한다.
		- 리턴할 때, ResponseEntity 객체로 처리..
	4) client단에서 다운로드 파일에 해당 파일을 확인한다.
2. 개발 순서
	1) 첨부파일 정보 리스트 처리 및 javascript이벤트로 특정 파일정보 클릭시 요청 처리..
		- dao
		- service
		- controller
		- jsp 화면구현 (테이블 형식 화면 구성 javascript 이벤트 처리)
	2) 파일다운로드 controller 클래스 선언..
	
# 다운로드 controller 처리
1. 다운로드 controller는 특정한 파일이나 정보를 요청값으로 받아서, 파일명과 서버의 경로명으로 파일 객체를 만들어,
해당 파일을 Steam 방식으로 요청하는 client에 전달하는 객체이다.
2. 처리 순서
	1) 경로명 지정 - 공통 properties에 설정된 내용
	2) 메서드 요청값 처리 - get방식으로 전달되어온 파일정보를 요청값으로 받아서, 위 경로명과 파일 객체를 만들어
	3) 클라이언트 전송을 위한 작업
		- 한글 파일의 경우, 네트워크를 통해 전달시 encoding이 필요로 한다. 
		- 전송시, 8진수 stream객체로 변경하기 위해서, contentType을 application/octet-steam으로 설정
		- ResponseEntity객체를 통해 요청이 정상 전달될 때 기준으로
			contentType
			header - 파일 정보
			body - 실제 전달할 파일 객체로
			각, 메서드별로 처리하여 return 하면 client(브라우저)를 통해 전달된다.
ex) 연습예제
A11_FileController.java
	fileList2
		첨부파일된
A12_FileService.java		
A13_FileDao.java
		조회리스트
		
#a03_fileList.jsp - 출력리스트, 검색 form, js 로 더블클릭시, 다운로드 controller 호출..
		
	 
B02_DownloadController.java
	download2
		 
			
		



			
	
	
	
				
			
		