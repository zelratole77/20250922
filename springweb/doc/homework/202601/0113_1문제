[마지막 정리]
## 1. [개념] 주관식 및 서술형 평가

**Q1. 파일 업로드의 물리적/논리적 처리 과정 (서술형)**
사용자가 브라우저에서 파일을 선택해 '등록' 버튼을 눌렀을 때, 서버측(Service단)에서 해당 파일을 **(1) 실제 서버 디렉토리에 저장하는 과정**과 **(2) DB에 파일 정보를 기록하는 과정**의 상관관계를 설명하세요. 특히 `mf.transferTo(file)`의 역할은 무엇인지 포함하여 서술하세요.

**Q2. MyBatis `@SelectKey`의 필요성 (주관식)**
게시글 하나에 여러 개의 파일이 등록되는 1:N 관계에서, `boardInsert` 메서드에 `@SelectKey`를 사용하여 게시글 번호(`no`)를 미리 가져오는 이유는 무엇입니까? 만약 이 과정이 없다면 파일 정보 저장 시 어떤 문제가 발생하는지 기술하세요.

**Q3. 파일 다운로드의 브라우저 동작 원리 (서술형)**
상세 화면에서 파일명을 클릭했을 때, 브라우저가 해당 파일을 '텍스트로 읽지 않고' 다운로드 창을 띄우게 하려면 Controller에서 어떤 처리가 필요한지 논리적으로 설명하세요. (힌트: Response 헤더와 스트림 전송)

**Q4. 세션(Session) 기반 권한 제어의 메커니즘 (서술형)**
로그인 성공 시 `HttpSession`에 사용자 정보를 저장한 후, 다른 페이지(글쓰기, 수정 등)로 이동했을 때 서버가 "이 사용자가 로그인 상태인지"를 판단하는 전체 프로세스를 서술하세요.

---

## 2. [실습] 사이버 수사대: 디지털 증거 관리 시스템 구축

> **상황:** 당신은 사이버 수사대의 백엔드 개발자입니다. 범죄 증거물(파일)을 안전하게 관리하고 수사관(로그인 사용자)만 접근 가능한 시스템을 구현해야 합니다.

### **[미션 1] 다중 증거물 업로드 로직 완성 (Code Logic)**

다음은 증거물을 등록하는 서비스 단의 일부입니다. 빈칸에 들어갈 적절한 로직을 구상하세요.

```java
public String uploadEvidence(Board board) {
    // 1. [문제] 게시글(사건 개요)을 먼저 DB에 등록하여 시퀀스 번호를 확보해야 합니다.
    // 어떤 메서드를 호출해야 하며, 이때 board 객체의 no 값은 어떻게 변화합니까?
    
    // 2. [문제] MultipartFile[] 배열을 순회하며 파일이 존재할 때만 업로드를 수행하는 
    // 조건문과 실제 저장 로직(transferTo)을 설계하세요. (파일명 중복은 고려하지 않음)
    
    // 3. [문제] 파일이 성공적으로 서버에 복사되었다면, DB의 'boardfile' 테이블에 
    // 게시글 번호와 파일명을 매칭하여 저장하는 메서드를 호출하세요.
}

```

### **[미션 2] 보안 다운로드 인터페이스 (JSP & JS)**

수사관들이 상세 페이지에서 증거물을 확인하는 화면입니다. 다음 요구사항을 코드로 구현하세요.

1. **더블 클릭 이벤트:** 증거물 파일명이 적힌 버튼을 `dblclick` 했을 때 `download(파일명)` 함수가 호출되도록 HTML 속성을 작성하세요.
2. **JS 확인창:** `download` 함수 내부에서 `confirm()`을 사용하여 "증거물을 확보하시겠습니까?"라는 메시지를 띄우고, '확인'을 누를 때만 서버의 `/download` 경로로 요청을 보내는 스크립트를 작성하세요.

### **[미션 3] 불법 접근 차단 (Controller & Session)**

누군가 로그인하지 않은 상태에서 URL을 통해 직접 게시판 리스트(` /boardList`)에 접근하려고 합니다.

1. Controller의 `boardList` 메서드에서 세션에 저장된 사용자 정보(예: `mem`)가 `null`인지 확인하고, `null`일 경우 다시 로그인 페이지로 리다이렉트 시키는 코드를 작성하세요.
2. JSP 페이지 상단에서 JSTL의 `<c:if>` 혹은 자바스크립트를 활용해 세션 정보가 없을 경우 "로그인이 필요합니다"라는 알림창을 띄우는 로직을 작성하세요.

### **[미션 4] 수정/삭제 버튼 노출 로직 (Access Control)**

* 사건 보고서 상세 보기 화면(`detail.jsp`)에서, 현재 로그인한 수사관의 아이디(`${mem.id}`)와 보고서 작성자(`${board.writer}`)가 **일치할 때만** [수정]과 [삭제] 버튼이 화면에 보이도록 하는 JSTL 태그 코드를 작성하세요.
