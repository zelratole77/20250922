# ajax
1. 개념(ajax란 무엇인가?)
	AJAX(Asynchronous Javascript and XML)는 웹 페이지 전체를 새로고침하지 않고도, 서버와 데이터를
	주고 받아 페이지의 일부분만 업데이터할 수 있는 핵심 기술입니다.
2. 왜 ajax인가?
	기존의 웹 방식은 작은 데이터를 변경하려 해도 페이지 전체를 다시 불러와야 했습니다. ajax를 사용하면 다음과 같은 장점이 있습니다.
	- 사용자 경험(UX) 향상 : 화면 깜빡임 없이 부드러운 전환이 가능합니다.
	- 서버 부하 감소 : 필요한 데이터만 전송하므로 트래픽이 줄어듭니다.
	- 비동기성 : 데이터를 요청하고 응답을 기다리는 동안에도 사용자는 다른 작업을 할 수 있습니다.
3. 작동 원리(workflow)
	1) 이벤트 발생(버튼 클릭 등)
	2) javascript가 서버로 XMLHttpRequest 또는 fetch 요청을 보냄
	3) 서버가 처리 후 응답(json, xml등)을 보냄
	4) javascript가 응답 데이터를 받아 DOM을 조작하여 화면에 반영
4. jquery ajax의 기본형식과 주요 속성.
	1) 기본 형식
		$.ajax({
			url:"call01",  
			type:"get",
			data:{name:"홍길동"},
			dataType:"string",  // xml, json
			success:function(res){
				alert("결과:"+res)
			},
			error:function(err){
				console.log(err)
			}
		})
	2) 주요 속성
		url : 어디로 주문할까?  서버단에 url 주소로 호출하는 것을 말한다. spring에서는 controller 요청 메서드 호출.
		type : 어떻게 보낼까? 서버단에 호출하는 method 방식을 말한다. get/post/put/delete 방식을 사용할 수 있다.
		data : 무엇을 보낼까? 서버에 전달할 요청값을 처리하는 형식을 말한다. 일단적으로 알고 있는 문자열로 key=value
			도 가능하고, jquery에서는 {} json형식으로 요청키와 요청값을 처리할 수 있다.
		dataType : 요청한 내용을 서버에서 결과로 가지고 올 때, 데이터 유형을 지정하는 것을 말한다. default가 결과를
			문자열로 가져오는 것이고, json으로 설정하는 서버단에서 오는 문자열형식이 json형식으로 객체로 변경되어 처리된다.	
		success : 성공하면 뭐 하지? 서버단에 요청 후, 결과값을 받아서 처리하는 것을 말한다. 매개변수로 결과 내용을 서버에서
			받아 처리할 수 있다.
		error : ajax처리시 서버단 내부 에러나 기타 에러가 발생하여 정상적인 처리를 못 할 때, 해당 에러에 대한 내용을
			매개변수로 err로 받을 수 있다.
5. server단에 처리되는 형식들..
	1) @ResponseBody 
		 - 요청 처리를 하면 contoller단에 특정 메서드가 문자열을 전달 처리하는 형태를 말한다.
		 return 유형이 문자열을 처리한다.
		 - 때로는 json 데이터를 처리할 수도 있고, 문자열 형식의 json데이터 클라이언트에서 속성에 따라 json 객체로 받아서
		 	처리할 수 있다.
	2) ResponseEntity<유형>
		- 요청값을 처리하여 결과 데이터를 처리하는 형식을 return 값자체가 ResponseEntity.ok(데이터유형)으로 설정하여
			client에 해당 데이터 유형으로 전달을 할 수 있다.
		- 일반적으로 데이터 처리 결과를 VO ==> json 객체까지 처리가 가능한 형태이다.
			 
# ajax 처리 단계별 처리 내용
1. 초기 화면 로딩, 클릭시 요청 문자열 전달 받아서 처리(v)
2. 요청값을 전달하고, 그 요청값에 따른 결과를 문자열 데이터 받아서 처리.
	요청값 처리 속성 - type, data 속성으로 요청key/값을 type에 따라서 호출한다.
	서버에서는 이 데이터를 요청 처리 @RequestParam, 모델어트리뷰터로 처리하여,
	내부 로직에 의하여 처리된 결과를 문자열로 리턴한다.
	해당 문자열은 javascript의 success 함수를 받아 결과를 처리한다.
	A02_AjaxController.java
		/callReqInit  - 초기화면 로딩
		/callReqAjax01
		로 요청값을 받아서 연산한 결과 처리(이름 받아서 !! @@@님 안녕하세요 라고 전달하는 메서드)
	a08_ajax\a02_ajaxReqView.jsp (요청값 연습하는 view단 처리)
		이름 : [    ] [ajax처리] 라고 하면, 서버단에 메시지를 보내고 안녕하세요라고
			서버에서 결과값 받은 ajax 처리..
3. 요청값 전달, 결과를 json데이터 받아서 처리
	class Person{
		String name;  ==> new Person("홍길동", 25) ==> {"name":"홍길동","age":25}  객체를 json 형태로 처리..
		int age;
	}
	서버단
	ResponseEntity<Person>.ok(new Person("홍길동", 25));
	client (ajax)
	$.ajax({
		dataType:"json",
		success:function( person ){
			person.name ==> 서버에서 받은 객체를 json형태로 처리가 가능하다.
			person.age
		}
	}) 



4. 요청값 전달, DB 처리, 결과를 json데이터 받아서 처리.
5. ajax를 이용한 CRUD 화면 처리 예제.


# [실무 예제] 회원가입시, 회원 아이디 중복여부 처리..
1. 기본 프로세스
	회원 아이디를 입력할 때, 해당 회원아이디가 중복여부가 있는지 여부를 확인하고, 처리하는 것을 말한다.
	결국, 등록할 회원 아이디가 중복이 되지 않을 때, 해당 아이디로 회원등록이 가능하여야 하기에, ajax로 입력한 아이디를
	비동기적으로 중복여부를 확인 한다.
	화면에 아이디값을 입력 후, 중복여부 버튼을 클릭시, 요청값으로 controller단에 id가 넘겨가고 service dao를 
	통해서 sql(select count(*) from member where id=#{id}로 확인 하여 service단에서
	public String isValidId(String id){
		return dao.IsValidId(id)>0?"중복된 아이디가 있습니다":"중복된 아이디가 없습니다"
	}
	로, 처리되어 controller단에 msg로 중복여부를 전달하고, 그 내용를 화면단에서 처리한다..
2. 개발 처리
	1) 개발할 파일 정리
		A03_AjaxDBController.java
			/isValidId=id
			isValidId()
		A04_AjaxDBService.java
			isValidId(String id)
		A05_AjaxDBDao.java
			int isValidId(@Param("id"))
			
		/a08_ajax/a04_registerMember.jsp
	
	2) 단계별 처리 내용 핵심..
		sql 작성  : SELECT COUNT(*) FROM MEMBER WHERE ID=#{id}
		dao
		service
		controller
		jsp
			등록할 아이디:[     ] [중복확인]
			
	

# ajax를 활용한 맛집 관리 프로그래밍
1. 화면 단위 기능
	1) 키워드로 전체 리스트 검색
	2) 등록 처리 화면(모달)
	3) 상세 화면(모달)
		- 수정
		- 삭제
2. 처리할 파일
	a06_ajax_mvc  패키지
	A01_GourmetController.java
	A02_GourmetService.java
	A03_GourmetDao.java
	GourmetStore.java
	a08_ajax/a06_gourmetMng.jsp
	
sql
dto(GourmetStore.java)
dao
service
controller
	/gourmetMngView (초기view단 호출)
	/gourmetList  (ajax)
	 
view(jsp)	

# 맛집 등록 처리
1. 처리 프로세스
	리스트 화면에서 등록 버튼을 클릭, 모달창으로 form형식의 등록하는 화면이 로딩된다.
	데이터를 입력 후, 등록 버튼을 클릭하면, ajax를 통해서 입력된 데이터가 post방식으로
	서버에 controller에 전달되고, 전달된 데이터는 service, dao를 거쳐서 데이터 등록 처리를
	하고, 그 결과 등록성공/등록실패를 다시 client에 전달하여 출력하여 등록 처리가 완료된다.
	등록 처리 후에는 비동기적으로 등록된 데이터를 확인 할 수 있는 리스트 화면이 처리되고,
	등록 화면을 닫으면 다시, 등록된 리스트를 확인할 수 있다.
2. 개발 순서
	1) DB 처리
		sql
		dao
	2) service - 등록성공/등록실패
	3) controller
		/insertGourmet  post방식
	4) view(jsp)
		모달창에 등록 form 처리 내용 구현..
		등록버튼 클릭시, $.ajax() 처리..
		success:function(msg){}
			등록 성공메시지와, 전체 리스트 검색 메서드 호출하여 등록된 데이터가 리스트되게 한다.
			
# 맛집 수정/삭제를 위한 상세 데이터 로딩 개발 순서			
1) DB 처리
	sql
	dao
2) service 단일 데이터
3) controller
	/getGourmet  get방식
3) view(jsp)
	리스트 데이터 중에 하나를 더블클릭시, 해당 key과 함께.. 모달창이 로딩되고,
	필요한 타이틀(맛집 상세), 기능버튼(수정/삭제) 로딩 처리..
	ajax로 controller 호출 및, form에 DB통해 가져온 데이터 mapping 처리하기..
			
		
# 런치메뉴 수정/삭제를 위한 상세 데이터 로딩 개발 순서			
1) DB 처리
	sql
	dao
	------------------------------
2) service 단일 데이터
3) controller
	/getLunchMenu  get방식
3) view(jsp)
	리스트 데이터 중에 하나를 더블클릭시, 해당 key과 함께.. 모달창이 로딩되고,
	필요한 타이틀(맛집 상세), 기능버튼(수정/삭제) 로딩 처리..
	ajax로 controller 호출 및, form에 DB통해 가져온 데이터 mapping 처리하기..
			
				







		
# 점심 메뉴 리스트 처리
A02_LunchMenuController.java
A02_LunchMenuService.java
A02_LunchMenuDao.java
LunchMenu.java
a08_ajax\a07_lunchMng.jsp
SELECT * FROM LUNCH_MENU;

SELECT menu_id, category, menu_name FROM LUNCH_MENU WHERE menu_name LIKE '%%' AND category LIKE '%%';

1. sql

2. dto
3. dao
---------
4. service
5. controller
	/lunchView
	/lunchMenuList
	
6. jsp


# 점심메뉴 등록
개발 순서
	1) DB 처리
		sql
		dao
	---------------------------------	
	2) service - 등록성공/등록실패
	3) controller
		/insertLunchMenu  post방식
	--------------------	
	4) view(jsp)
		모달창에 등록 form 처리 내용 구현..
		모달창 로딩시 타이틀과 기능버튼 show/hide 처리.
		등록버튼 클릭시, $.ajax() 처리..
		success:function(msg){}
			등록 성공메시지와, 전체 리스트 검색 메서드 호출하여 등록된 데이터가 리스트되게 한다.


	
			
	











	

	
	
	
				
			
			
				